# PentestAPI

PentestAPI is a collection of penetration testing tools exposed as RESTful APIs. This project aims to provide an easy way to integrate various pentest tools into your workflows and applications.

## Table of Contents

- [Introduction](#introduction)
- [Features](#features)
- [Getting Started](#getting-started)
- [Usage](#usage)
  - [Nmap API](#nmap-api)
  - [SQL Injection Scanner API](#sql-injection-scanner-api)
  - [Directory Listing API](#directory-listing-api)
  - [Stored XSS Scanner API](#stored-xss-scanner-api)
- [Contributing](#contributing)
- [License](#license)

## Introduction

PentestAPI simplifies the use of penetration testing tools by offering them as easy-to-use APIs. Currently, the project includes APIs for Nmap, SQL Injection scanning, directory listing, and stored XSS scanning, with more tools to be added in the future.

## Features

- **Nmap API:** Perform network scans using Nmap via a RESTful API.
- **SQL Injection Scanner API:** Detect SQL injection vulnerabilities on web applications.
- **Directory Listing API:** Enumerate directories on a target server and show results based on HTTP status codes.
- **Stored XSS Scanner API:** Detect stored XSS vulnerabilities on web applications.

## Getting Started

### Prerequisites

- [Node.js](https://nodejs.org/) (v18.20.1 or higher)
- [Nmap](https://nmap.org/)

### Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/MohakGupta2004/PentestAPI.git
   cd PentestAPI
   ```

2. Install the dependencies:
   ```bash
   npm install
   ```

3. Ensure Nmap is installed and accessible from the command line:
   ```bash
   nmap --version
   ```

### Running the Server

Start the server with:
```bash
npm start
```

The server will run on `http://localhost:3000`.

## Usage

### Nmap API

The Nmap API allows you to perform network scans and retrieve the results in raw Nmap output format.

#### Endpoint

- **POST /nmap**

  Initiate a new Nmap scan.

  **Request Body:**

  ```json
  {
    "target": "127.0.0.1",
    "options": "-sV"
  }
  ```

  - `target`: The target hostname or IP address to scan.
  - `options`: (Optional) Nmap options to use for the scan. Defaults to `-sT`.

  **Response:**

  The response will be the raw Nmap output as a string.

  **Example Response:**

  ```
  Starting Nmap 7.80 ( https://nmap.org ) at 2024-08-04 14:30
  Nmap scan report for 127.0.0.1
  Host is up (0.00012s latency).
  Not shown: 998 closed ports
  PORT    STATE SERVICE VERSION
  22/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
  80/tcp  open  http    Apache httpd 2.4.29 ((Ubuntu))
  MAC Address: 00:0C:29:6B:8E:7E (VMware)
  ```

#### Example Request

To initiate a scan on `127.0.0.1` with the default options, you can use `curl`:

```bash
curl -X POST http://localhost:3000/nmap -H "Content-Type: application/json" -d '{"target":"127.0.0.1"}'
```

### SQL Injection Scanner API

The SQL Injection Scanner API allows you to check for SQL injection vulnerabilities on a specified target using the `http-sql-injection` Nmap script.

#### Endpoint

- **POST /sqli**

  Scan a target for SQL injection vulnerabilities.

  **Request Body:**

  ```json
  {
    "target": "http://example.com"
  }
  ```

  - `target`: The target URL to scan for SQL injection vulnerabilities.

  **Response:**

  The response will be the raw Nmap output as a string.

  **Example Response:**

  ```
  Starting Nmap 7.80 ( https://nmap.org ) at 2024-08-04 14:35
  Nmap scan report for example.com (93.184.216.34)
  Host is up (0.045s latency).
  rDNS record for 93.184.216.34: example.com

  PORT   STATE SERVICE
  80/tcp open  http
  |_http-sql-injection: [INFO] GET parameter 'id' is vulnerable.

  Nmap done: 1 IP address (1 host up) scanned in 2.12 seconds
  ```

#### Example Request

To scan `http://example.com` for SQL injection vulnerabilities, you can use `curl`:

```bash
curl -X POST http://localhost:3000/sqli -H "Content-Type: application/json" -d '{"target":"http://example.com"}'
```

### Directory Listing API

The Directory Listing API checks for the existence of directories on a specified target and returns results based on HTTP status codes (200, 301, 403).

#### Endpoint

- **POST /dir-list**

  Enumerate directories on a target server.

  **Request Body:**

  ```json
  {
    "target": "http://example.com"
  }
  ```

  - `target`: The base URL to check for directories.

  **Response:**

  The response will be a list of directories with their HTTP status codes where a directory was found.

  **Example Response:**

  ```json
  [
    {
      "url": "http://example.com/admin",
      "status": 200
    },
    {
      "url": "http://example.com/uploads",
      "status": 403
    }
  ]
  ```

#### Example Request

To enumerate directories on `http://example.com`, you can use `curl`:

```bash
curl -X POST http://localhost:3000/dir-list -H "Content-Type: application/json" -d '{"target":"http://example.com"}'
```

### Stored XSS Scanner API

The Stored XSS Scanner API allows you to check for stored XSS vulnerabilities on a specified target using the `http-stored-xss` Nmap script.

#### Endpoint

- **POST /xss-stored**

  Scan a target for stored XSS vulnerabilities.

  **Request Body:**

  ```json
  {
    "target": "http://example.com"
  }
  ```

  - `target`: The target URL to scan for stored XSS vulnerabilities.

  **Response:**

  The response will be the raw Nmap output as a string.

  **Example Response:**

  ```
  Starting Nmap 7.80 ( https://nmap.org ) at 2024-08-04 14:40
  Nmap scan report for example.com (93.184.216.34)
  Host is up (0.045s latency).
  rDNS record for 93.184.216.34: example.com

  PORT   STATE SERVICE
  80/tcp open  http
  |_http-stored-xss: [INFO] GET parameter 'username' is vulnerable.

  Nmap done: 1 IP address (1 host up) scanned in 2.12 seconds
  ```

#### Example Request

To scan `http://example.com` for stored XSS vulnerabilities, you can use `curl`:

```bash
curl -X POST http://localhost:3000/xss-stored -H "Content-Type: application/json" -d '{"target":"http://example.com"}'
```

## Contributing

Contributions are welcome! Please submit a pull request or open an issue to discuss any changes or additions.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
```

This updated `README.md` now includes comprehensive details for the Stored XSS Scanner API, including usage, request format, and example responses. Let me know if there's anything else youâ€™d like to add or modify!